  ###########################
  #    OPENCTI Connector    #
  ###########################

  # ┌──────────────────────────────────────┐
  # │ CISA Known Exploited Vulnerabilities │
  # └──────────────────────────────────────┘
  connector-cisa-known-exploited-vulnerabilities:
    image: opencti/connector-cisa-known-exploited-vulnerabilities:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────────────────────┐
  # │ CriminalIP C2-Daily-Feed │
  # └──────────────────────────┘
  connector-criminalip-c2-daily-feed:
    image: opencti/connector-criminalip-c2-daily-feed:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_TYPE=EXTERNAL_IMPORT
      - "CONNECTOR_NAME=Criminal IP C2 Daily Feed"
      - CONNECTOR_SCOPE=ipv4-addr
      - CONNECTOR_LOG_LEVEL=error
      - CRIMINALIP_INTERVAL=1 #Day
      - CRIMINALIP_CONFIDENCE_SCORE=100
      - CRIMINALIP_CSV_URL=https://raw.githubusercontent.com/criminalip/C2-Daily-Feed/refs/heads/main
    restart: always
    depends_on:
      opencti:
        condition: service_healthy
  
  # ┌────────────┐
  # │ Threat Fox │
  # └────────────┘
  connector-threatfox:
    image: opencti/connector-threatfox:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌─────────┐
  # │ URLhaus │
  # └─────────┘
  connector-urlhaus:
    image: opencti/connector-urlhaus:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=Abuse.ch URLhaus
      - CONNECTOR_SCOPE=urlhaus
      - CONNECTOR_LOG_LEVEL=error
      - URLHAUS_INTERVAL=3
      - URLHAUS_CSV_URL=https://urlhaus.abuse.ch/downloads/csv_recent/
      - URLHAUS_DEFAULT_X_OPENCTI_SCORE=80 # Optional: Defaults to 80.
      - URLHAUS_IMPORT_OFFLINE=true
      - URLHAUS_THREATS_FROM_LABELS=true
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌─────┐
  # │ Wiz │
  # └─────┘
  connector-wiz:
    image: opencti/connector-wiz:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=Wiz Cloud Threat LandScape
      - CONNECTOR_SCOPE=wiz
      - CONNECTOR_LOG_LEVEL=error
      - CONNECTOR_DURATION_PERIOD=P1D # ISO8601 format in String, start with 'P...' for Period
      - WIZ_THREAT_ACTOR_AS_INTRUSION_SET=False
      - WIZ_TLP_LEVEL=clear
    restart: always
    depends_on:
      opencti:
        condition: service_healthy
  # ┌──────────┐
  # │ VX Vault │
  # └──────────┘
  connector-vxvault:
    image: opencti/connector-vxvault:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=VX Vault URL list"
      - CONNECTOR_SCOPE=vxvault
      - CONNECTOR_LOG_LEVEL=error
      - VXVAULT_URL=https://vxvault.net/URL_List.php
      - VXVAULT_CREATE_INDICATORS=true
      - VXVAULT_INTERVAL=3 # In days, must be strictly greater than 1
      - VXVAULT_SSL_VERIFY=False
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌───────────┐
  # │ Tweetfeed │
  # └───────────┘
  connector-tweetfeed:
    image: opencti/connector-tweetfeed:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=Tweetfeed
      - CONNECTOR_SCOPE=tweetfeed
      - CONNECTOR_LOG_LEVEL=error
      - TWEETFEED_CONFIDENCE_LEVEL=15 # From 0 (Unknown) to 100 (Fully trusted)
      - TWEETFEED_CREATE_INDICATORS=true
      - TWEETFEED_CREATE_OBSERVABLES=true
      - TWEETFEED_INTERVAL=1
      - TWEETFEED_UPDATE_EXISTING_DATA=true
      - "TWEETFEED_ORG_DESCRIPTION=Tweetfeed, a connector to import IOC from Twitter."
      - TWEETFEED_ORG_NAME=Tweetfeed
      - TWEETFEED_DAYS_BACK_IN_TIME=30 # Number of days to retrieve data back in time
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌───────────────┐
  # │ Stopforumspam │
  # └───────────────┘
  connector-stopforumspam:
    image: opencti/connector-stopforumspam:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=Stopforumspam
      - CONNECTOR_SCOPE=stopforumspam
      - CONNECTOR_LOG_LEVEL=error
      - STOPFORUMSPAM_URL=https://www.stopforumspam.com/downloads/toxic_domains_whole_filtered_50000.txt
      - STOPFORUMSPAM_CREATE_INDICATORS=true
      - STOPFORUMSPAM_INTERVAL=3 # In days, must be strictly greater than 1
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌────────────────┐
  # │ RansomwareLive │
  # └────────────────┘
  connector-ransomwarelive:
    image: opencti/connector-ransomwarelive:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=RansomwareLive
      - CONNECTOR_SCOPE=ransomwarelive
      - CONNECTOR_LOG_LEVEL=error
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────────────┐
  # │ Red Flag Domains │
  # └──────────────────┘
  connector-redflag-domains:
    image: opencti/connector-red-flag-domains:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=Red Flag Domains"
      - CONNECTOR_SCOPE=red-flag-domains
      - UPDATE_EXISTING_DATA=False
      - CONNECTOR_LOG_LEVEL=info
      - REDFLAGDOMAINS_URL=https://dl.red.flag.domains/daily/
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────────────┐
  # │ Aerospace SPARTA │
  # └──────────────────┘
  connector-sparta:
    image: opencti/connector-sparta:latest
    environment:
      # OpenCTI parameters - REQUIRED
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      # Connector's definition parameters - REQUIRED
      - CONNECTOR_ID= # Valid UUIDv4
      # Connector's definition parameters - OPTIONAL
      # - CONNECTOR_NAME=Aerospace SPARTA
      # - CONNECTOR_SCOPE=["attack-pattern", "course-of-action", "indicator", "identity"]
      # - CONNECTOR_LOG_LEVEL=error
      # - CONNECTOR_DURATION_PERIOD=PT5H
      # SPARTA definition parameters - OPTIONAL
      # - SPARTA_BASE_URL=https://sparta.aerospace.org/download/STIX?f=latest
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────┐
  # │ PGL Yoyo │
  # └──────────┘
  connector-pgl-yoyo:
    image: opencti/connector-pgl-yoyo:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=PGL Yoyo Ad Server Blocklist
      - CONNECTOR_SCOPE=observable
      - CONNECTOR_CONFIDENCE_LEVEL=50
      - CONNECTOR_LOG_LEVEL=info
      - CONNECTOR_DURATION_PERIOD=PT12H
      - CONNECTOR_UPDATE_EXISTING_DATA=true
      - PGL_BUNDLE_MODE=true
      - PGL_REPORT_PER_RUN=true
      - PGL_IDENTITY_NAME=Peter Lowe (PGL Blocklist)
      - PGL_IDENTITY_CLASS=organization
      - PGL_IDENTITY_DESCRIPTION=Curated ad server & tracking blocklist maintained by Peter G. Lowe (yoyo.org).
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────────────────────┐
  # │ montysecurity C2-Tracker │
  # └──────────────────────────┘
  connector-c2tracker:
    image: opencti/connector-montysecurity-c2-tracker:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_C2TRACKER_TOKEN= # Valid UUIDv4
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌─────────────┐
  # │ MITRE Atlas │
  # └─────────────┘
  connector-mitre-atlas:
    image: opencti/connector-mitre-atlas:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=MITRE ATLAS"
      - CONNECTOR_SCOPE=identity,attack-pattern,course-of-action,relationship,x-mitre-collection,x-mitre-matrix,x-mitre-tactic
      - CONNECTOR_RUN_AND_TERMINATE=false
      - CONNECTOR_LOG_LEVEL=error
      - MITRE_ATLAS_URL=https://raw.githubusercontent.com/mitre-atlas/atlas-navigator-data/main/dist/stix-atlas.json
      - MITRE_ATLAS_INTERVAL=7 # In days, must be strictly greater than 1
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌────────────┐
  # │ FIRST EPSS │
  # └────────────┘
  connector-first-epss-bulk:
    image: opencti/connector-first-epss-bulk:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME="External Import First EPSS Connector"
      - CONNECTOR_LOG_LEVEL=error
      - CONNECTOR_DURATION_PERIOD=PT24H
      # Connector's custom execution parameters
      - FIRST_EPSS_API_BASE_URL=https://epss.cyentia.com
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌──────────────────┐
  # │ DISARM Framework │
  # └──────────────────┘
  connector-disarm-framework:
    image: opencti/connector-disarm-framework:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=DISARM Framework"
      - CONNECTOR_SCOPE=marking-definition,identity,attack-pattern,course-of-action,intrusion-set,campaign,malware,tool,report,narrative,event,channel
      - CONNECTOR_RUN_AND_TERMINATE=false
      - CONNECTOR_LOG_LEVEL=error
      - DISARM_FRAMEWORK_URL=https://raw.githubusercontent.com/DISARMFoundation/DISARMframeworks/main/generated_files/DISARM_STIX/DISARM.json
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  #        ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓  
  #               ┌──────────────┐
  #         ↓↓↓   │ Need API Key │  ↓↓↓           
  #               └──────────────┘
  #                ↓↓↓↓↓↓↓↓↓↓↓↓↓↓
  
  # ┌────────────────────────────────────────────────────┐
  # │ CVE - NVD                                          │
  # | https://nvd.nist.gov/developers/request-an-api-key │
  # └────────────────────────────────────────────────────┘
  connector-cve:
    image: opencti/connector-cve:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CVE_API_KEY= # Required
    depends_on:
      opencti:
        condition: service_healthy

  # ┌───────────────────────────────┐
  # │ AbuseIPDB                     │
  # | https://www.abuseipdb.com/api │ 
  # └───────────────────────────────┘
  connector-abuseipdb-ipblacklist:
    image: opencti/connector-abuseipdb-ipblacklist:latest
    environment:
      # Connector's generic execution parameters
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      # Connector's definition parameters REQUIRED
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=AbuseIPDB IP Blacklist"
      - CONNECTOR_SCOPE=abuseipdb
      - CONNECTOR_LOG_LEVEL=error
      - ABUSEIPDB_API_KEY= # Required
      - CONNECTOR_DURATION_PERIOD=PT12H # ISO8601 format in String, start with 'P...' for Perio
      - ABUSEIPDB_TLP_LEVEL=clear
      - ABUSEIPDB_SCORE=75
      - ABUSEIPDB_LIMIT=1000
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌───────────────────────────────┐
  # │ URLhaus Recent Payloads       │
  # | https://urlhaus.abuse.ch/api/ │
  # └───────────────────────────────┘
  connector-urlhaus-recent-payloads:
    image: opencti/connector-urlhaus-recent-payloads:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - "CONNECTOR_NAME=URLhaus Recent Payloads"
      - CONNECTOR_LOG_LEVEL=error
      - URLHAUS_RECENT_PAYLOADS_API_URL=https://urlhaus-api.abuse.ch/v1/
      - URLHAUS_RECENT_PAYLOADS_API_KEY= # Required, issued for free by URLHaus - https://urlhaus-api.abuse.ch/#auth_key
      - URLHAUS_RECENT_PAYLOADS_COOLDOWN_SECONDS=300 # Time to wait in seconds between subsequent requests
      - URLHAUS_RECENT_PAYLOADS_INCLUDE_FILETYPES=exe,dll,docm,docx,doc,xls,xlsx,xlsm,js,xll # (Optional) Only download files if any tag matches. (Comma separated)
      - URLHAUS_RECENT_PAYLOADS_INCLUDE_SIGNATURES= # (Optional) Only download files matching these Yara rules. (Comma separated)
      - URLHAUS_RECENT_PAYLOADS_SKIP_UNKNOWN_FILETYPES=true # Skip files with an unknown file type
      - URLHAUS_RECENT_PAYLOADS_SKIP_NULL_SIGNATURE=true # Skip files that didn't match known Yara rules
      - URLHAUS_RECENT_PAYLOADS_LABELS=urlhaus # (Optional) Labels to apply to uploaded Artifacts. (Comma separated)
      - URLHAUS_RECENT_PAYLOADS_LABELS_COLOR=#54483b
      - URLHAUS_RECENT_PAYLOADS_SIGNATURE_LABEL_COLOR=#0059f7 # Color for Yara rule match label
      - URLHAUS_RECENT_PAYLOADS_FILETYPE_LABEL_COLOR=#54483b # Color to use for filetype label
    restart: always
    depends_on:
      opencti:
        condition: service_healthy

  # ┌────────────────────────────────┐
  # │ AlienVault                     │
  # | https://otx.alienvault.com/api │
  # └────────────────────────────────┘
  connector-alienvault:
    image: opencti/connector-alienvault:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=${OPENCTI_ADMIN_TOKEN}
      - CONNECTOR_ID= # Valid UUIDv4
      - CONNECTOR_NAME=AlienVault
      - CONNECTOR_SCOPE=alienvault
      - CONNECTOR_LOG_LEVEL=error
      - CONNECTOR_DURATION_PERIOD=PT30M # In ISO8601 Format starting with "P" for Period ex: "PT30M" = Period time of 30 minutes
      - ALIENVAULT_BASE_URL=https://otx.alienvault.com
      - ALIENVAULT_API_KEY= # Required
      - ALIENVAULT_TLP=White
      - ALIENVAULT_CREATE_OBSERVABLES=true
      - ALIENVAULT_CREATE_INDICATORS=true
      - ALIENVAULT_PULSE_START_TIMESTAMP=2022-05-01T00:00:00                  # BEWARE! Could be a lot of pulses!
      - ALIENVAULT_REPORT_TYPE=threat-report
      - ALIENVAULT_REPORT_STATUS=New
      - ALIENVAULT_GUESS_MALWARE=false                                        # Use tags to guess malware.
      - ALIENVAULT_GUESS_CVE=false                                            # Use tags to guess CVE.
      - ALIENVAULT_EXCLUDED_PULSE_INDICATOR_TYPES=FileHash-MD5,FileHash-SHA1  # Excluded Pulse indicator types.
      - ALIENVAULT_ENABLE_RELATIONSHIPS=true                                  # Enable/Disable relationship creation between SDOs.
      - ALIENVAULT_ENABLE_ATTACK_PATTERNS_INDICATES=false                     # Enable/Disable "indicates" relationships between indicators and attack patterns
      - ALIENVAULT_FILTER_INDICATORS=false                                    # Filter indicators by their created datetime
      - ALIENVAULT_INTERVAL_SEC=1800
      - ALIENVAULT_DEFAULT_X_OPENCTI_SCORE=50
      - ALIENVAULT_X_OPENCTI_SCORE_IP=60
      - ALIENVAULT_X_OPENCTI_SCORE_DOMAIN=70
      - ALIENVAULT_X_OPENCTI_SCORE_HOSTNAME=75
      - ALIENVAULT_X_OPENCTI_SCORE_EMAIL=70
      - ALIENVAULT_X_OPENCTI_SCORE_FILE=85
      - ALIENVAULT_X_OPENCTI_SCORE_URL=80
      - ALIENVAULT_X_OPENCTI_SCORE_MUTEX=60
      - ALIENVAULT_X_OPENCTI_SCORE_CRYPTOCURRENCY_WALLET=80
    restart: always
    depends_on:
      opencti:
        condition: service_healthy
